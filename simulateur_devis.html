<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulateur de devis</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div id="contenu-principal">
    <h2>Simulateur de devis</h2>

    <form id="devisForm">
        <label for="nom">Nom :</label>
        <input type="text" id="nom" name="nom" required><br><br>

        <label for="prenom">Prénom :</label>
        <input type="text" id="prenom" name="prenom" required><br><br>

        <label for="adresse">Adresse Postale :</label>
        <input type="text" id="adresse" name="adresse" required><br><br>

        <label for="codePostal">Code Postal :</label>
        <input type="text" id="codePostal" name="codePostal" required><br><br>

        <label for="ville">Ville :</label>
        <input type="text" id="ville" name="ville" required><br><br>

        <label for="telephone">Téléphone :</label>
        <input type="text" id="telephone" name="telephone" required><br><br>

        <label for="email">E-mail :</label>
        <input type="email" id="email" name="email" required><br><br>

        <label for="niveau">Niveau de Peinture :</label>
        <select id="niveau" name="niveau">
            <option value="niveau_1">Niveau 1</option>
            <option value="niveau_2">Niveau 2</option>
            <option value="niveau_3">Niveau 3</option>
        </select><br><br>

        <label for="infanterie">Nombre d'Infanteries :</label>
        <input type="number" id="infanterie" name="infanterie" min="0" value="0"><br><br>

        <label for="cavalerie">Nombre de Cavaleries :</label>
        <input type="number" id="cavalerie" name="cavalerie" min="0" value="0"><br><br>

        <label for="heros">Nombre de Héros à Pied :</label>
        <input type="number" id="heros" name="heros" min="0" value="0"><br><br>

        <label for="petitMonstre">Nombre de Petits Véhicules/Monstres :</label>
        <input type="number" id="petitMonstre" name="petitMonstre" min="0" value="0"><br><br>

        <label for="grosMonstre">Nombre de Gros Véhicules/Monstres :</label>
        <input type="number" id="grosMonstre" name="grosMonstre" min="0" value="0"><br><br>

        <p><strong>Total Estimé :</strong> <span id="total">0.00</span> €</p>

        <button type="button" id="envoyerBtn">Envoyer par e-mail</button>
    </form>

    <script>
        // Tarifs en JavaScript
        const tarifs = {
            "infanterie": { "niveau_1": 8.00, "niveau_2": 13.00, "niveau_3": 25.00 },
            "cavalerie_lourde": { "niveau_1": 11.00, "niveau_2": 18.00, "niveau_3": 35.00 },
            "heros_a_pied": { "niveau_1": 12.00, "niveau_2": 20.00, "niveau_3": 40.00 },
            "petit_vehicule_monstre": { "niveau_1": 15.00, "niveau_2": 25.00, "niveau_3": 50.00 },
            "gros_vehicule_monstre": { "niveau_1": 50.00, "niveau_2": 75.00, "niveau_3": 150.00 }
        };

        // Fonction de mise à jour du total
        function updateTotal() {
            const niveau = document.getElementById("niveau").value;
            const infanterie = parseInt(document.getElementById("infanterie").value) || 0;
            const cavalerie = parseInt(document.getElementById("cavalerie").value) || 0;
            const heros = parseInt(document.getElementById("heros").value) || 0;
            const petitMonstre = parseInt(document.getElementById("petitMonstre").value) || 0;
            const grosMonstre = parseInt(document.getElementById("grosMonstre").value) || 0;

            const total = 
                (tarifs.infanterie[niveau] * infanterie) +
                (tarifs.cavalerie_lourde[niveau] * cavalerie) +
                (tarifs.heros_a_pied[niveau] * heros) +
                (tarifs.petit_vehicule_monstre[niveau] * petitMonstre) +
                (tarifs.gros_vehicule_monstre[niveau] * grosMonstre);

            document.getElementById("total").textContent = total.toFixed(2);
        }

        // Écoute des événements pour mettre à jour dynamiquement
        document.getElementById("devisForm").addEventListener("input", updateTotal);

        // Fonction d'envoi par e-mail
        document.getElementById("envoyerBtn").addEventListener("click", function() {
            const formData = new FormData(document.getElementById("devisForm"));
            formData.append('total', document.getElementById("total").textContent);

            fetch('envoyer_devis.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.text())
            .then(data => {
                alert(data); // Affiche la réponse du serveur
            })
            .catch(error => {
                console.error('Erreur:', error);
                alert('Une erreur est survenue.');
            });
        });
    </script>
</body>
</html>

